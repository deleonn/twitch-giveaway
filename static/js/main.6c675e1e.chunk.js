(this["webpackJsonp@deleonn/twitch-giveaway"]=this["webpackJsonp@deleonn/twitch-giveaway"]||[]).push([[0],{125:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(84),i=n.n(a),o=n(8),s=n.n(o),l=n(14),u=n(3),j=n(144),h=n(136),d=Object(h.a)({colors:{brand:{900:"#1a365d",800:"#153e75",700:"#2a69ac"}}}),b={isLoading:!1,isLogged:!1,currentUser:void 0,handleLogin:function(){},handleLogout:function(){}},f=r.a.createContext(b),x=n(138),O=n(12),p=n(88),g=n(5),m=n(137),v=n(42),w=n(140),y=n(139),k=n(141),S=n(145),C=n(2);function _(){var e=Object(c.useContext)(f),t=e.handleLogout,n=e.currentUser;return Object(C.jsxs)(m.a,{w:"100%",alignItems:"flex-start",mb:4,children:[Object(C.jsx)(x.a,{children:Object(C.jsxs)(y.a,{size:"md",children:["Welcome,",Object(C.jsx)("br",{}),Object(C.jsx)(w.a,{color:"purple.300",as:"i",children:null===n||void 0===n?void 0:n.username}),Object(C.jsx)("br",{}),"to your followers giveaway! \ud83d\udd25"]})}),Object(C.jsx)(k.a,{}),Object(C.jsx)(x.a,{children:Object(C.jsx)(S.a,{colorScheme:"red",size:"xs",onClick:t,children:"Log out"})})]})}var L=n(146);function I(){return Object(C.jsx)(m.a,{w:"inherit",h:"100vh",justifyContent:"center",alignItems:"center",children:Object(C.jsx)(L.a,{color:"purple.500",size:"xl",thickness:"4px",speed:"0.65s",emptyColor:"gray.200"})})}function z(e){var t=e.followers,n=e.total,c=e.isFetching,a=e.handleFollowersChange,i=r.a.useState([]),o=Object(u.a)(i,2),s=o[0],l=o[1];r.a.useEffect((function(){return j()}),[t]),r.a.useEffect((function(){a(s)}),[s]);var j=function(){var e=t.map((function(e){return Object(v.a)(Object(v.a)({},e),{},{checked:!0})}));l(e)};return Object(C.jsx)(x.a,{h:"100vh",bg:"gray.900",w:"300px",children:Object(C.jsxs)(m.a,{p:4,h:"100%",direction:"column",children:[c&&Object(C.jsx)(I,{}),!c&&Object(C.jsxs)(C.Fragment,{children:[Object(C.jsxs)(w.a,{color:"white",fontSize:"xl",mb:4,children:["You have"," ",Object(C.jsxs)(w.a,{as:"b",color:"purple.300",children:[n," followers"]})," ",n>0?"\u2764\ufe0f":"\ud83d\ude23"]}),Object(C.jsxs)(x.a,{overflowY:"scroll",flex:"1",children:[Object(C.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:Object(C.jsxs)("label",{htmlFor:"checkAll",style:{display:"flex",alignItems:"center",marginBottom:"0.5rem"},children:[Object(C.jsx)("input",{type:"checkbox",id:"Check All",onClick:function(e){return function(e){var t=s.map((function(t){return Object(v.a)(Object(v.a)({},t),{},{checked:e.target.checked})}));l(t)}(e)},defaultChecked:!0}),Object(C.jsx)(w.a,{color:"white",style:{marginLeft:"0.5rem"},children:"Check All"})]})}),s.length&&s.map((function(e,t){return Object(C.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:Object(C.jsxs)("label",{htmlFor:e.from_name,style:{display:"flex",alignItems:"center",marginBottom:"0.5rem"},children:[Object(C.jsx)("input",{type:"checkbox",id:e.from_name,checked:e.checked,onChange:function(){return function(e){var t=Object(g.a)(s);t[e].checked=!t[e].checked,l(t)}(t)}}),Object(C.jsx)(w.a,{color:"white",style:{marginLeft:"0.5rem"},children:e.from_name})]})},e.followed_at)}))]})]})]})})}var F=n(143),A=["Choosing the best follower...","Removing blacklisted users...","Ay..."];function B(e){var t=e.followers,n=r.a.useState(!1),c=Object(u.a)(n,2),a=c[0],i=c[1],o=r.a.useState(!1),s=Object(u.a)(o,2),l=s[0],j=s[1],h=r.a.useState(A[0]),d=Object(u.a)(h,2),b=d[0],f=d[1],O=r.a.useState(""),p=Object(u.a)(O,2),g=p[0],v=p[1],y=function(){var e;v("");var t=0;e||(j(!0),i(!0),f(A[0]),e=setInterval((function(){t<=A.length-1?(f(A[t]),j(!1),t++):(j(!1),i(!1),f(""),clearInterval(e),e=null,k()),j(!0)}),500))},k=function(){var e=Math.floor(Math.random()*t.length),n=t[e];v(n.from_name)};return Object(C.jsxs)(m.a,{p:4,direction:"column",flex:1,children:[Object(C.jsx)(_,{}),Object(C.jsxs)(m.a,{flex:1,direction:"column",justifyContent:"center",alignItems:"center",children:[!g&&Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(S.a,{size:"lg",colorScheme:"purple",isLoading:a,onClick:y,mb:4,disabled:!t.length||a,children:"Choose a winner!"}),Object(C.jsx)(F.a,{in:l,children:Object(C.jsx)(w.a,{color:"purple.300",children:b})}),Object(C.jsx)(w.a,{children:l})]}),g&&Object(C.jsxs)(x.a,{textAlign:"center",children:[Object(C.jsxs)(F.a,{in:!!g,children:[Object(C.jsxs)(w.a,{fontSize:"4xl",children:["And the winner is..."," ",Object(C.jsxs)(w.a,{as:"span",color:"purple.600",fontWeight:"bold",children:[g,"!"]})]}),Object(C.jsx)(w.a,{fontSize:"lg",color:"purple.400",as:"i",children:"Ay!"})]}),Object(C.jsx)(S.a,{size:"sm",colorScheme:"purple",isLoading:a,onClick:y,mt:4,disabled:!t.length||a,children:"Re-roll?"})]})]})]})}var E=n(86),U=n.n(E).a.create({timeout:1e4}),D="hcrl44m41p6p1u3lwg84suqm5d6cwi",M="https://id.twitch.tv/oauth2/authorize?client_id=".concat(D,"&redirect_uri=").concat("https://deleonn.github.io/twitch-giveaway","&response_type=").concat("token","&scope=").concat("channel:read:subscriptions user:read:email"),P=function(){var e=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.get("https://id.twitch.tv/oauth2/validate",{headers:{Authorization:"OAuth ".concat(t)}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(l.a)(s.a.mark((function e(t,n,c){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.get("https://api.twitch.tv/helix/users/follows",{params:{to_id:t,first:100,after:c},headers:{Authorization:"Bearer ".concat(n),"Client-Id":D}});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),T=[];var J=function(){var e=r.a.useState([]),t=Object(u.a)(e,2),n=t[0],a=t[1],i=r.a.useState([]),o=Object(u.a)(i,2),j=o[0],h=o[1],d=r.a.useState(!0),b=Object(u.a)(d,2),x=b[0],O=b[1],p=r.a.useState(void 0),v=Object(u.a)(p,2),w=v[0],y=v[1],k=Object(c.useContext)(f).currentUser;r.a.useEffect((function(){S()}),[]);var S=function(){var e=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(null===k||void 0===k?void 0:k.user_id,null===k||void 0===k?void 0:k.access_token,t);case 2:if(n=e.sent,T.push.apply(T,Object(g.a)(n.data)),!n.pagination.cursor){e.next=8;break}return e.abrupt("return",S(n.pagination.cursor));case 8:y(n.total),O(!1),a(T);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(C.jsxs)(m.a,{children:[Object(C.jsx)(z,{followers:n,total:w,isFetching:x,handleFollowersChange:function(e){h(e.filter((function(e){return!0===e.checked})))}}),Object(C.jsx)(B,{followers:j})]})},W=n(87),Y=n(67),q=n(147),G=n(91);function Z(){var e=Object(W.a)(),t=e.handleSubmit,n=e.errors,c=e.formState;return Object(C.jsxs)("form",{onSubmit:t((function(){window.open(M,"_self")})),children:[Object(C.jsx)(Y.a,{isInvalid:n.name,children:Object(C.jsx)(q.a,{children:n.name&&n.name.message})}),Object(C.jsx)(S.a,{mt:4,colorScheme:"purple",isLoading:c.isSubmitting,type:"submit",w:"100%",leftIcon:Object(C.jsx)(G.a,{}),children:"Sign in with Twitch"})]})}var H=function(){return Object(C.jsx)(m.a,{bg:"gray.900",height:"100vh",justifyContent:"center",alignItems:"center",children:Object(C.jsxs)(x.a,{bg:"white",w:"400px",p:4,borderRadius:5,children:[Object(C.jsx)(w.a,{fontSize:"3xl",children:"Sign in"}),Object(C.jsxs)(w.a,{fontSize:"sm",children:["Give your followers something special \u2764\ufe0f ",Object(C.jsx)("br",{}),"Use your twitch account to get started."]}),Object(C.jsx)(Z,{})]})})},K=Object(C.jsx)(O.c,{children:Object(C.jsx)(O.a,{path:"/",component:J})}),N=Object(C.jsx)(O.c,{children:Object(C.jsx)(O.a,{path:"/",component:H})});var Q=function(){var e=Object(c.useContext)(f),t=e.isLogged,n=e.isLoading;return Object(C.jsx)(p.a,{children:Object(C.jsx)(x.a,{children:n?Object(C.jsx)(I,{}):t?K:N})})};var V=function(){var e=r.a.useState(!1),t=Object(u.a)(e,2),n=t[0],c=t[1],a=r.a.useState(!1),i=Object(u.a)(a,2),o=i[0],h=i[1],b=r.a.useState(void 0),x=Object(u.a)(b,2),O=x[0],p=x[1];r.a.useEffect((function(){h(!0);var e=document.location.hash.match(/#access_token=([a-zA-Z0-9]*)/g);if(null===e||void 0===e?void 0:e.length){var t=e[0].substring(14);(function(){var e=Object(l.a)(s.a.mark((function e(){var n,c,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t);case 2:if(n=e.sent,c=n.login,r=n.user_id,!n){e.next=8;break}return p({user_id:r,username:c,access_token:t}),localStorage.setItem("access_token",t),e.abrupt("return",g());case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}else h(!1)}),[]);var g=function(){c(!0),h(!1),localStorage.setItem("is_logged","true")};return Object(C.jsx)(f.Provider,{value:{currentUser:O,isLogged:n,isLoading:o,handleLogin:g,handleLogout:function(){c(!1),localStorage.removeItem("is_logged"),localStorage.removeItem("access_token"),document.location.hash=""}},children:Object(C.jsx)(j.a,{theme:d,children:Object(C.jsx)(Q,{})})})},X=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,148)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};i.a.render(Object(C.jsx)(r.a.StrictMode,{children:Object(C.jsx)(V,{})}),document.getElementById("root")),X()}},[[125,1,2]]]);
//# sourceMappingURL=main.6c675e1e.chunk.js.map