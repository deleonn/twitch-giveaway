(this["webpackJsonp@deleonn/twitch-giveaway"]=this["webpackJsonp@deleonn/twitch-giveaway"]||[]).push([[0],{112:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(0),a=n.n(c),s=n(74),o=n.n(s),i=n(6),l=n.n(i),u=n(16),j=n(3),h=n(130),d=n(122),b=Object(d.a)({colors:{brand:{900:"#1a365d",800:"#153e75",700:"#2a69ac"}}}),x={isLoading:!0,isLogged:!1,currentUser:void 0,handleLogin:function(){},handleLogout:function(){}},f=a.a.createContext(x),O=n(124),p=n(12),g=n(79),v=n(123),m=n(126),w=n(125),S=n(127),y=n(131);function C(){var e=Object(c.useContext)(f),t=e.handleLogout,n=e.currentUser;return Object(r.jsxs)(v.a,{w:"100%",alignItems:"flex-start",mb:4,children:[Object(r.jsx)(O.a,{children:Object(r.jsxs)(w.a,{size:"md",children:["Welcome,",Object(r.jsx)("br",{}),Object(r.jsx)(m.a,{color:"purple.300",as:"i",children:null===n||void 0===n?void 0:n.username}),Object(r.jsx)("br",{}),"to your followers giveaway! \ud83d\udd25"]})}),Object(r.jsx)(S.a,{}),Object(r.jsx)(O.a,{children:Object(r.jsx)(y.a,{colorScheme:"red",size:"xs",onClick:t,children:"Log out"})})]})}var k=n(132);function L(){return Object(r.jsx)(v.a,{w:"inherit",h:"100vh",justifyContent:"center",alignItems:"center",children:Object(r.jsx)(k.a,{color:"purple.500",size:"xl",thickness:"4px",speed:"0.65s",emptyColor:"gray.200"})})}function _(e){var t=e.followers,n=e.total,c=e.isFetching;return Object(r.jsx)(O.a,{h:"100vh",bg:"gray.900",w:"300px",children:Object(r.jsxs)(v.a,{p:4,h:"100%",direction:"column",children:[c&&Object(r.jsx)(L,{}),!c&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(m.a,{color:"white",fontSize:"xl",mb:4,children:["You have"," ",Object(r.jsxs)(m.a,{as:"b",color:"purple.300",children:[n," followers"]})," ","\u2764\ufe0f"]}),Object(r.jsx)(O.a,{overflowY:"scroll",flex:"1",children:t.map((function(e){return Object(r.jsx)(a.a.Fragment,{children:Object(r.jsx)(m.a,{color:"white",children:e.from_name})},e.followed_at)}))})]})]})})}var I=n(129),z=["Connecting to the private server...","Choosing the best follower...","Removing blacklisted users...","Computing results..."];function F(e){var t=e.followers,n=a.a.useState(!1),c=Object(j.a)(n,2),s=c[0],o=c[1],i=a.a.useState(!1),l=Object(j.a)(i,2),u=l[0],h=l[1],d=a.a.useState(z[0]),b=Object(j.a)(d,2),x=b[0],f=b[1],p=a.a.useState(""),g=Object(j.a)(p,2),w=g[0],S=g[1],k=function(){var e;S("");var t=0;e||(h(!0),o(!0),f(z[0]),e=setInterval((function(){t<=z.length-1?(f(z[t]),h(!1),t++):(h(!1),o(!1),f(""),clearInterval(e),e=null,L()),h(!0)}),1e3))},L=function(){var e=Math.floor(Math.random()*t.length),n=t[e];S(n.from_name)};return Object(r.jsxs)(v.a,{p:4,direction:"column",flex:1,children:[Object(r.jsx)(C,{}),Object(r.jsxs)(v.a,{flex:1,direction:"column",justifyContent:"center",alignItems:"center",children:[!w&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(y.a,{size:"lg",colorScheme:"purple",isLoading:s,onClick:k,mb:4,children:"Choose a winner!"}),Object(r.jsx)(I.a,{in:u,children:Object(r.jsx)(m.a,{color:"purple.300",children:x})}),Object(r.jsx)(m.a,{children:u})]}),w&&Object(r.jsxs)(O.a,{textAlign:"center",children:[Object(r.jsxs)(I.a,{in:!!w,children:[Object(r.jsxs)(m.a,{fontSize:"4xl",children:["And the winner is..."," ",Object(r.jsxs)(m.a,{as:"span",color:"purple.600",fontWeight:"bold",children:[w,"!"]})]}),Object(r.jsx)(m.a,{fontSize:"lg",color:"purple.400",as:"i",children:"Ay!"})]}),Object(r.jsx)(y.a,{size:"sm",colorScheme:"purple",isLoading:s,onClick:k,mt:4,children:"Re-roll?"})]})]})]})}var A=n(76),U=n.n(A).a.create({timeout:1e4}),B="hcrl44m41p6p1u3lwg84suqm5d6cwi",E="https://id.twitch.tv/oauth2/authorize?client_id=".concat(B,"&redirect_uri=").concat("https://deleonn.github.io/twitch-giveaway","&response_type=").concat("token","&scope=").concat("channel:read:subscriptions user:read:email"),M=function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.get("https://id.twitch.tv/oauth2/validate",{headers:{Authorization:"OAuth ".concat(t)}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(u.a)(l.a.mark((function e(t,n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.get("https://api.twitch.tv/helix/users/follows",{params:{to_id:t,first:100},headers:{Authorization:"Bearer ".concat(n),"Client-Id":B}});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();var R=function(){var e=a.a.useState([]),t=Object(j.a)(e,2),n=t[0],s=t[1],o=a.a.useState(!0),i=Object(j.a)(o,2),h=i[0],d=i[1],b=a.a.useState(void 0),x=Object(j.a)(b,2),O=x[0],p=x[1],g=Object(c.useContext)(f).currentUser;a.a.useEffect((function(){m()}),[]);var m=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(null===g||void 0===g?void 0:g.user_id,null===g||void 0===g?void 0:g.access_token);case 2:t=e.sent,p(t.total),s(t.data),d(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(v.a,{children:[Object(r.jsx)(_,{followers:n,total:O,isFetching:h}),Object(r.jsx)(F,{followers:n})]})},T=n(77),J=n(52),W=n(133),Y=n(80);function q(){var e=Object(T.a)(),t=e.handleSubmit,n=e.errors,c=e.formState;return Object(r.jsxs)("form",{onSubmit:t((function(){window.open(E)})),children:[Object(r.jsx)(J.a,{isInvalid:n.name,children:Object(r.jsx)(W.a,{children:n.name&&n.name.message})}),Object(r.jsx)(y.a,{mt:4,colorScheme:"purple",isLoading:c.isSubmitting,type:"submit",w:"100%",leftIcon:Object(r.jsx)(Y.a,{}),children:"Sign in with Twitch"})]})}var D=function(){return Object(r.jsx)(v.a,{bg:"gray.900",height:"100vh",justifyContent:"center",alignItems:"center",children:Object(r.jsxs)(O.a,{bg:"white",w:"400px",p:4,borderRadius:5,children:[Object(r.jsx)(m.a,{fontSize:"3xl",children:"Sign in"}),Object(r.jsxs)(m.a,{fontSize:"sm",children:["Give your followers something special \u2764\ufe0f ",Object(r.jsx)("br",{}),"Use your twitch account to get started."]}),Object(r.jsx)(q,{})]})})},G=Object(r.jsx)(p.c,{children:Object(r.jsx)(p.a,{path:"/",component:R})}),Z=Object(r.jsx)(p.c,{children:Object(r.jsx)(p.a,{path:"/",component:D})});var H=function(){var e=Object(c.useContext)(f),t=e.isLogged,n=e.isLoading;return Object(r.jsx)(g.a,{children:Object(r.jsx)(O.a,{children:n?Object(r.jsx)(L,{}):t?G:Z})})};var K=function(){var e=a.a.useState(!1),t=Object(j.a)(e,2),n=t[0],c=t[1],s=a.a.useState(!1),o=Object(j.a)(s,2),i=o[0],d=o[1],x=a.a.useState(void 0),O=Object(j.a)(x,2),p=O[0],g=O[1];a.a.useEffect((function(){d(!0);var e=document.location.hash.match(/#access_token=([a-zA-Z0-9]*)/g);if(null===e||void 0===e?void 0:e.length){var t=e[0].substring(14);(function(){var e=Object(u.a)(l.a.mark((function e(){var n,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(t);case 2:if(n=e.sent,r=n.login,c=n.user_id,!n){e.next=8;break}return g({user_id:c,username:r,access_token:t}),localStorage.setItem("access_token",t),e.abrupt("return",v());case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}else d(!1)}),[]);var v=function(){c(!0),d(!1),localStorage.setItem("is_logged","true")};return Object(r.jsx)(f.Provider,{value:{currentUser:p,isLogged:n,isLoading:i,handleLogin:v,handleLogout:function(){c(!1),localStorage.removeItem("is_logged"),localStorage.removeItem("access_token"),document.location.hash=""}},children:Object(r.jsx)(h.a,{theme:b,children:Object(r.jsx)(H,{})})})},N=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,134)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))};o.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(K,{})}),document.getElementById("root")),N()}},[[112,1,2]]]);
//# sourceMappingURL=main.30c858f5.chunk.js.map