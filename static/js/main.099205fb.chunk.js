(this["webpackJsonp@deleonn/twitch-giveaway"]=this["webpackJsonp@deleonn/twitch-giveaway"]||[]).push([[0],{113:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n(0),a=n.n(c),o=n(75),i=n.n(o),s=n(7),u=n.n(s),l=n(17),j=n(5),d=n(131),h=n(123),b=Object(h.a)({colors:{brand:{900:"#1a365d",800:"#153e75",700:"#2a69ac"}}}),O={isLogged:!1,currentUser:void 0,handleLogin:function(){},handleLogout:function(){}},v=a.a.createContext(O),x=n(13),f=n(80),g=n(125),p=n(124),m=n(126);function w(e){var t=e.followers,n=e.total;return Object(r.jsx)(p.a,{h:"100vh",bg:"gray.900",w:"300px",children:Object(r.jsxs)(g.a,{p:4,h:"100%",direction:"column",children:[Object(r.jsxs)(m.a,{color:"white",fontSize:"xl",mb:4,children:["You have"," ",Object(r.jsxs)(m.a,{as:"b",color:"purple.300",children:[n," followers"]})," ","\u2764\ufe0f"]}),Object(r.jsx)(p.a,{overflowY:"scroll",flex:"1",children:t.map((function(e){return Object(r.jsx)(a.a.Fragment,{children:Object(r.jsx)(m.a,{color:"white",children:e.from_name})},e.followed_at)}))})]})})}var S=n(132),_=n(130),C=n(127),T=n(128);function E(){var e=Object(c.useContext)(v),t=e.handleLogout,n=e.currentUser;return Object(r.jsxs)(g.a,{w:"100%",alignItems:"flex-start",mb:4,children:[Object(r.jsx)(p.a,{children:Object(r.jsxs)(C.a,{size:"md",children:["Welcome,",Object(r.jsx)("br",{}),Object(r.jsx)(m.a,{color:"purple.300",as:"i",children:null===n||void 0===n?void 0:n.username}),Object(r.jsx)("br",{}),"to your followers giveaway! \ud83d\udd25"]})}),Object(r.jsx)(T.a,{}),Object(r.jsx)(p.a,{children:Object(r.jsx)(S.a,{colorScheme:"red",size:"xs",onClick:t,children:"Log out"})})]})}var I=["Connecting to the private server...","Choosing the best follower...","Removing blacklisted users...","Computing results..."];function y(){var e=a.a.useState(!1),t=Object(j.a)(e,2),n=t[0],c=t[1],o=a.a.useState(!1),i=Object(j.a)(o,2),s=i[0],u=i[1],l=a.a.useState(I[0]),d=Object(j.a)(l,2),h=d[0],b=d[1];return Object(r.jsxs)(g.a,{p:4,direction:"column",flex:1,children:[Object(r.jsx)(E,{}),Object(r.jsxs)(g.a,{flex:1,direction:"column",justifyContent:"center",alignItems:"center",children:[Object(r.jsx)(S.a,{size:"lg",colorScheme:"purple",isLoading:n,onClick:function(){var e,t=0;e||(u(!0),c(!0),b(I[0]),e=setInterval((function(){t<=I.length-1?(b(I[t]),u(!1),t++,console.log("Counting",t),console.log("Showing",s)):(u(!1),c(!1),b(""),console.log("Exiting",t),clearInterval(e),e=null),u(!0)}),2500))},mb:4,children:"Choose a winner!"}),Object(r.jsx)(_.a,{in:s,children:Object(r.jsx)(m.a,{color:"purple.300",children:h})}),Object(r.jsx)(m.a,{children:s})]})]})}var L=n(77),k=n.n(L).a.create({timeout:1e4}),R=Object({NODE_ENV:"production",PUBLIC_URL:"/twitch-giveaway",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_TWITCH_CLIENT_ID,P=Object({NODE_ENV:"production",PUBLIC_URL:"/twitch-giveaway",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_TWITCH_REDIRECT_URI,A="https://id.twitch.tv/oauth2/authorize?client_id=".concat(R,"&redirect_uri=").concat(P,"&response_type=").concat("token","&scope=").concat("channel:read:subscriptions user:read:email"),D=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get("https://id.twitch.tv/oauth2/validate",{headers:{Authorization:"OAuth ".concat(t)}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get("https://api.twitch.tv/helix/users/follows",{params:{to_id:t},headers:{Authorization:"Bearer ".concat(n),"Client-Id":R}});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();var U=function(){var e=a.a.useState([]),t=Object(j.a)(e,2),n=t[0],o=t[1],i=a.a.useState(void 0),s=Object(j.a)(i,2),d=s[0],h=s[1],b=Object(c.useContext)(v).currentUser;a.a.useEffect((function(){O()}),[]);var O=function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(null===b||void 0===b?void 0:b.user_id,null===b||void 0===b?void 0:b.access_token);case 2:t=e.sent,h(t.total),o(t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(g.a,{children:[Object(r.jsx)(w,{followers:n,total:d}),Object(r.jsx)(y,{})]})},F=n(78),W=n(53),H=n(133),K=n(81);function B(){var e=Object(F.a)(),t=e.handleSubmit,n=e.errors,c=e.formState;return Object(r.jsxs)("form",{onSubmit:t((function(){window.open(A)})),children:[Object(r.jsx)(W.a,{isInvalid:n.name,children:Object(r.jsx)(H.a,{children:n.name&&n.name.message})}),Object(r.jsx)(S.a,{mt:4,colorScheme:"purple",isLoading:c.isSubmitting,type:"submit",w:"100%",leftIcon:Object(r.jsx)(K.a,{}),children:"Sign in with Twitch"})]})}var N=function(){return Object(r.jsx)(g.a,{bg:"gray.900",height:"100vh",justifyContent:"center",alignItems:"center",children:Object(r.jsxs)(p.a,{bg:"white",w:"400px",p:4,borderRadius:5,children:[Object(r.jsx)(m.a,{fontSize:"3xl",children:"Sign in"}),Object(r.jsxs)(m.a,{fontSize:"sm",children:["Give your followers something special \u2764\ufe0f ",Object(r.jsx)("br",{}),"Use your twitch account to get started."]}),Object(r.jsx)(B,{})]})})},J=Object(r.jsx)(x.c,{children:Object(r.jsx)(x.a,{path:"/",component:U})}),V=Object(r.jsx)(x.c,{children:Object(r.jsx)(x.a,{path:"/",component:N})});var Y=function(){var e=Object(c.useContext)(v).isLogged;return Object(r.jsx)(f.a,{children:e?J:V})};var G=function(){var e=a.a.useState(!1),t=Object(j.a)(e,2),n=t[0],c=t[1],o=a.a.useState(void 0),i=Object(j.a)(o,2),s=i[0],h=i[1];a.a.useEffect((function(){var e=document.location.hash.match(/#access_token=([a-zA-Z0-9]*)/g);if(null===e||void 0===e?void 0:e.length){var t=e[0].substring(14);(function(){var e=Object(l.a)(u.a.mark((function e(n){var r,c,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(t);case 2:if(r=e.sent,c=r.login,a=r.user_id,!r){e.next=8;break}return h({user_id:a,username:c,access_token:t}),localStorage.setItem("access_token",t),e.abrupt("return",O());case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})()(t)}}),[]);var O=function(){c(!0),localStorage.setItem("is_logged","true")};return Object(r.jsx)(v.Provider,{value:{currentUser:s,isLogged:n,handleLogin:O,handleLogout:function(){c(!1),localStorage.removeItem("is_logged"),localStorage.removeItem("access_token"),document.location.hash=""}},children:Object(r.jsx)(d.a,{theme:b,children:Object(r.jsx)(Y,{})})})},M=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,134)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),a(e),o(e)}))};i.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(G,{})}),document.getElementById("root")),M()}},[[113,1,2]]]);
//# sourceMappingURL=main.099205fb.chunk.js.map